<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Introduction to SQL</title>

        <meta name="description" content="Introduction to SQL presentation for the LBS Technology Club">
        <meta name="author" content="Qi-Shan Lim">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/q.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section>
                    <h1>Introduction to SQL</h1>
                    <h5>Presentation for the LBS Technology Club</h5>
                    <img src="https://pbs.twimg.com/profile_images/260297549/Logo_Tech_Club_Small.jpg" width="120em" height="120em"/>
                    <p>
                        <small><a href="http://github.com/qlim">Qi-Shan Lim</a> / <a href="http://twitter.com/qmanic">@qmanic</a></small>
                    </p>
                </section>

                <section>
                    <h2>What are we covering today?</h2>
                    <ul>
                        <li>Relational databases - the basics</li>
                        <li>Simple SELECT queries with WHERE, ORDER BY</li>
                        <li>Aggregation - SUM, AVERAGE</li>
                        <li>Simple JOINs</li>
                    </ul>
                </section>
                <section>
                    <h2>What are we not covering?</h2>
                    <ul>
                        <li>This is an introduction only!</li>
                        <li>This is not about database design</li>
                        <li>This is a general SQL introduction and not about specific database systems</li>
                        <li>Many systems have nice frontends that help you build queries - you can often get
                        away without manually writing any SQL at all. Frontends differ by system but are easy to 
                        pick up - especially if you have a basic understanding of the underlying SQL</li>
                    </ul>
                </section>

                <section>
                    <h2>What is SQL?</h2>

                    <p class="fragment">
                    <strong>S</strong>tructured
                    <strong>Q</strong>uery
                    <strong>L</strong>anguage
                    <br />
                    is a tool for manipuating data in
                    <br />
                    <u>relational databases</u>
                    </p>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT firstName, lastName, countryCode, city
FROM Customers
WHERE countryCode="US";
                    </code></pre>
                    </figure>
                </section>

                <section>
                    <h2>Relational databases are everywhere</h2>
                    <p class="list-lead-in">Some examples of database systems that use SQL</p>
                    <ul class="smaller60">
                        <li>Microsoft Access</li>
                        <li>Microsoft SQL Server</li>
                        <li>Oracle RDBMS</li>
                        <li>IBM DB2</li>
                        <li>SAP Sypbase</li>
                        <li>MySQL</li>
                        <li>PostgreSQL</li>
                        <li>Amazon SimpleDB</li>
                    </ul>
                    <p class="fragment">
                    Although SQL is standardised, differences <strong>do</strong> exist between systems
                    </p>
                    <p class="fragment">
                    We will be using MS Access in this tutorial but will be using a basic subset of SQL
                    that is broadly universal
                    </p>
                </section>

                <section>
                    <h2>Why learn SQL?</h2>
                    <p>In business you might want to:</p>
                    <ul>
                        <li><strong>Extract</strong> a subset of data from a larger dataset - 
                        <strong>filter</strong> it to only include data you're interested in and maybe
                        <strong>sort</strong> it while you're at it</li>
                        <li><strong>Transform</strong> data by performing calculations on it</li>
                        <li><strong>Summarise</strong> complex data (e.g. computing sums or averages)</li>
                        <li><strong>Insert</strong> new data or <strong>delete</strong> existing data from a 
                        dataset (out of scope for today)</li>
                    </ul>
                    <p>And of course, databases are behind a lot of mobile and web applications</p>
                </section>

                <section>
                    <h2>What is a relational database?</h2>
                    <p>
                    A relational database is a collection of <strong>tables</strong>,
                    <br />
                    which have <strong>columns</strong> and <strong>rows</strong>

                    <figure class="fragment small">
                    <figcaption>Table: <span class="mono">customers</span></figcaption>
                    <pre><code data-trim contenteditable class="language-sql">
customerId   firstName   lastName    countryCode   city
==========   =========   =========   ===========   =========
1            Andy        Dwyer       US            Pawnee
2            Bruce       Bullerby    GB            London
3            Carrie      Bradshaw    US            New York
4            D'Angelo    Barksdale   US            Baltimore
...

                    </code></pre>
                    </figure>

                    <figure class="fragment small">
                    <figcaption>Table: <span class="mono">transactions</span></figcaption>
                    <pre><code data-trim contenteditable class="language-sql">
transactionId   customerId   productId   timestamp             quantity
=============   ==========   =========   ===================   ========
1               2            1           2014-05-04T22:44:43   4
2               3            1           2014-05-04T22:48:21   3
3               3            2           2014-05-04T22:48:21   12
...
                    </code></pre>
                    </figure>

                </section>

                <section>
                    <h2>More about tables</h2>
                    <ul>
                        <li class="fragment">A table is a collection of entries - each row is an entry, e.g. a customer</li>
                        <li class="fragment">The columns of a table define the what information is stored for each entry - e.g. their name, address etc.</li>
                        <li class="fragment">Each column has a <i>type</i> - it could be a number, text ('string'), date etc. Different database systems support different types</li>
                        <li class="fragment">A common column found in tables (though not always) is a unique identifier for each row - e.g. 'customerId'. These are often used to link data in different tables (e.g. customerId appears in our transactions table) </li>
                    </ul>
                </section>

                <section>
                    <h2>Example: Your first SELECT query</h2>
                    <p>A SELECT query is used to get information out of a database. It's probably the most common type of query you will write</p>
                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT customerId, firstName, lastName, countryCode 
FROM Customers;
                    </code></pre>
                    </figure>
                    <p class="fragment">You should get output like this:</p>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
customerId   firstName   lastName    countryCode
==========   =========   =========   ===========
1            Andy        Dwyer       US         
2            Bruce       Bullerby    GB         
3            Carrie      Bradshaw    US         
4            D'Angelo    Barksdale   US         
...

                    </code></pre>
                    </figure>

                    <aside class="notes">
                        Open Access, load database, create blank query with Query Design, switch to SQL view
                    </aside>

                </section>

                <section>
                    <h2>Deconstructing your first SELECT query</h2>
                        <ul>
                            <li>The start of every SQL query tells you what sort of query you are running, 
                            in this case, it's SELECT</li>
                            <li>Next comes the list of columns that you want to see in the output, separated by
                            commas</li>
                            <li>The FROM clause specifies which table the columns reside in</li>
                            <li>Finally, every SQL query ends with a semicolon</li>

                        </ul>
                    </h2>
                </section>

                <section>
                    <h2>Exercise: Simple SELECT query</h2>
                    <p>Write a query that selects the transactionId and timestamp columns from the
                    transactions table
                    </p>
                </section>

                <section>
                    <h2>Filtering using a WHERE clause</h2>
                    <p>Often you will only want to select rows that match a certain criteria. You can add a
                    WHERE clause to your SELECT query that will specify which rows to include</p>
                    <p>This example selects only customers whose countryCode is 'US':</p>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT *
FROM Customers
WHERE countryCode = 'US';
                    </code></pre>
                    </figure>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
customerId   firstName   lastName    countryCode   city
==========   =========   =========   ===========   =========
1            Andy        Dwyer       US            Pawnee
3            Carrie      Bradshaw    US            New York
4            D'Angelo    Barksdale   US            Baltimore
...

                    </code></pre>
                    </figure>
                </section>

                <section>
                    <h2>Deconstructing your new query</h2>
                        <ul>
                            <li>You can use '*' as a shorthand to mean 'select all of the columns in the table'
                            instead of listing them explicitly</li>
                            <li>The WHERE clause comes after the FROM and is followed by a conditional expression. Only rows that meet the criteria will be included in the final output</li>

                        </ul>
                    </h2>
                </section>

                <section>
                    <h2>Conditional expressions</h2>
                    <p>Conditional expressions should be fairly familiar to you if you've used them elsewhere - 
                    e.g. and IF() function in Excel, although there are some differences</p>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
WHERE column = 'text'       -- test for equality
WHERE column = 2            -- also works for numbers
WHERE column &gt; 5            -- greater than is '&gt;', less than is '&lt;'
WHERE column &lt;&gt; 8           -- test for inequality
WHERE c1 = 'US' AND c2 &lt; 10 -- you can combine conditions with AND 
WHERE (c1 = 'US' AND        -- use parentheses to clarify order of operations
  c2 &lt; 10) OR c1 = 'GB'     
                    </code></pre>
                    </figure>

                </section>

                <section>
                    <h2>Exercise: Filtering with WHERE</h2>
                    <p>Write a query to select all columns for transactions that occurred prior to 1-Jan-2014</p>
                </section>

                <section>
                    <h2>Sorting the results of a query with ORDER BY</h2>
                    <p>You may want to order the results of a query in a certain way. You can specify this
                    using an ORDER BY clause in your SELECT</p>
                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT *
FROM Customers
WHERE countryCode = 'US'
ORDER BY lastName ASC;
                    </code></pre>
                    </figure>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
customerId   firstName   lastName    countryCode   city
==========   =========   =========   ===========   =========
4            D'Angelo    Barksdale   US            Baltimore
3            Carrie      Bradshaw    US            New York
1            Andy        Dwyer       US            Pawnee
...

                    </code></pre>
                    </figure>

                </section>

                <section>
                    <h2>Understanding ORDER BY</h2>
                    <ul>
                        <li>ORDER BY comes after any WHERE clause (if there is one) and is followed by the column to sort on, and then either ASC (ascending) or DESC (descending)</li>
                        <li>If you omit the direction, ASC is assumed</li>
                        <li>You can add additional sorting criteria (to break ties), by separating them with a comma:</li>
                    </ul>
                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT *
FROM Customers
WHERE countryCode = 'US'
ORDER BY lastName ASC, firstName ASC;
                    </code></pre>
                    </figure>
                </section>

                <section>
                    <h2>Exercise: sorting with ORDER BY</h2>
                    <p>Write a query to select all transactions occurring in the month of April 2014, sorted
                    so that the transaction with the largest value comes first. If two transactions have the
                    same value, a transaction with a lower customerId should come first</p>
                </section>

                <section>
                    <h2>Expressions in SELECT statements</h2>
                    <p>So far we have just been giving the database a list of columns that we want to see in
                    the output of our query, as-is</p>
                    <p>However, we can also ask the database to perform calculations on the data as well</p>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT customerId, firstName + ' ' + lastName AS fullName, 
  tier + 10 AS tierPlus10
FROM Customers
ORDER BY tierPlus10 DESC;
                    </code></pre>
                    </figure>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
customerId   fullName             tierPlus10
==========   ==================   ==========
4            D'Angelo Barksdale   19
1            Andy Dwyer           16
3            Carrie Bradshaw      15
2            Bruce Bullerby       14
...

                    </code></pre>
                    </figure>


                </section>

                <section>
                    <h2>Explaining expressions</h2>
                    <ul>
                        <li>Instead of simply specifying the column name, we use an expression to tell the database
                        how to calculate that column in our output</li>
                        <li>We can specify a label for that output column by using 'AS' after the expression with
                        a name</li>
                        <li>Expressions can get complex! As well as basic math, most databases come with lots of
                        in-built functions that can be used</li>
                        <li>Unfortuately, different database systems offer different functions, so you will need
                        to find out what's available for your given system</li>
                    </ul>

                </section>

                <section>
                    <h2>More expression examples (Access)</h2>
                    <p>Calculating the months since the customer first joined</p>
                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT lastName, DateDiff('m', joinDate, Now()) AS monthsActive 
FROM Customers
ORDER BY monthsActive DESC;
                    </code></pre>
                    </figure>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
lastName     monthsActive 
==========   ============
Dwyer        15
Bullerby     11
Bradshaw     3
Barksdale    2
...

                    </code></pre>
                    </figure>


                </section>

                <section>
                    <h2>More expression examples (Access)</h2>
                    <p>You can even include 'IF' functions</p>
                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT IIf(tier &gt; 5, '*' + firstName, firstName) as highlightedName, tier
FROM Customers;
                    </code></pre>
                    </figure>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
highlightedName   tier 
===============   ====
*Andy             6
Bruce             4
Carrie            5
*D'Angelo         9
...

                    </code></pre>
                    </figure>
                </section>


                <section>
                    <h2>Exercise: expressions</h2>
                    <p>Write a query to retrieve all sales this year, and include the average unit price
                    for each transaction</p>
                </section>


                <section>
                    <h2>Aggregation with GROUP BY</h2>
                    <p>A common task is to summarise information from multiple rows in a table into a single row</p>
                    <p>For example, we may want to know, for each customerId in our transactions table, what
                    is the sum of the value of all transactions for that customer?</p>
                    <p>We can add a GROUP BY clause to our SELECT queries to achieve this</p>

                </section> 

                <section>
                    <h2>Aggregation with GROUP BY</h2>
                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
SELECT customerId, Sum(salesValue) as salesValueSum 
FROM Sales
GROUP BY customerId;
                    </code></pre>
                    </figure>

                    <figure class="fragment">
                    <pre><code data-trim contenteditable class="language-sql">
customerId   salesValueSum
==========   =============
1            22
2            6
3            18
...

                    </code></pre>
                    </figure>


                </section>

                <section>
                    <h2>Explaining GROUP BY</h2>
                    <ul>
                        <li>You can think of GROUP BY as being similar to Pivot Tables in Excel</li>
                        <li>In the example, we tell the database that we want to combine rows with the same
                        customerId together into a single row in our output. We do this by specifying its 
                        column name after the GROUP BY clause</li>
                        <li>After 'SELECT' we need to list the columns we want in the output as usual, but if
                        we list a column that does <strong>not</strong> appear after GROUP BY, we also need
                        to tell the database which function to use to combine values from multiple rows. In this
                        case we use the Sum function to tell Access to add the values of salesValue together</li>
                        <li>You can specify multiple columns as part of a GROUP BY clause, to get all unique
                        combinations of values in those columns</li>

                    </ul>
                </section>

                <section>
                    <h2>Exercise: GROUP BY</h2>
                    <p>Write a query to calculate the total sales and average unit sell price for every
                    customer &amp; product combination</p>
                </section>


                <section>
                    <h2>TODO</h2>
                    <ul>
                        <li>date literals</li>
                        <li>GROUP BY - AVG, MAX, COUNT</li>
                        <li>JOIN</li>
                        <li>explain NULL</li>
                        <li>dealing with non std column names</li>
                        <li>Good learning resources</li>
                    </ul>
                </section>

                <section>
                    <h1>THE END</h1>
                </section>

            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Parallax scrolling
                // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
                // parallaxBackgroundSize: '2100px 900px',

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>

    </body>
</html>
